<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clinix Cup 2025 - Group Draw</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Lato:wght@400;700&display=swap');

        :root {
            --primary-color: #007bff; /* Bright Blue */
            --secondary-color: #28a745; /* Green */
            --accent-color: #ffc107; /* Yellow */
            --background-color: #f8f9fa; /* Light Grey */
            --text-color: #343a40; /* Dark Grey */
            --group-a-bg: #17a2b8; /* Cyan */
            --group-b-bg: #6f42c1; /* Purple */
            --group-c-bg: #fd7e14; /* Orange */
            --group-d-bg: #20c997; /* Teal */
            --card-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Lato', sans-serif;
            background: linear-gradient(to right, #e0f7fa, #e8f5e9);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            min-height: 100vh;
        }

        .navbar {
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .navbar a {
            font-family: 'Poppins', sans-serif;
            text-decoration: none;
            color: #fff;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: bold;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            cursor: pointer;
        }
        
        .navbar a.active {
            background-color: var(--primary-color);
        }

        .navbar a:hover:not(.active) {
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }

        .navbar .male-link { background-color: var(--primary-color); }
        .navbar .female-link { background-color: #dc3545; }

        .container {
            width: 100%;
            max-width: 900px;
            background-color: #fff;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            padding: 30px;
            box-sizing: border-box;
            border: 3px solid var(--primary-color);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: '';
            position: absolute;
            top: -50px;
            left: -50px;
            width: 150px;
            height: 150px;
            background-color: var(--accent-color);
            border-radius: 50%;
            opacity: 0.1;
            z-index: 0;
        }
        .container::after {
            content: '';
            position: absolute;
            bottom: -50px;
            right: -50px;
            width: 200px;
            height: 200px;
            background-color: var(--secondary-color);
            border-radius: 50%;
            opacity: 0.08;
            z-index: 0;
        }

        h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.8em;
            color: var(--primary-color);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 5px;
            position: relative;
            z-index: 1;
        }

        h2 {
            font-family: 'Poppins', sans-serif;
            font-size: 2em;
            color: var(--secondary-color);
            text-transform: uppercase;
            margin-top: 5px;
            margin-bottom: 20px;
            position: relative;
            z-index: 1;
        }

        .spin-wheel-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-top: 30px;
            position: relative;
            z-index: 1;
        }

        .wheel-container {
            width: 500px;
            height: 500px;
            position: relative;
            margin-bottom: 30px;
            box-shadow: var(--card-shadow);
            border-radius: 50%;
            background-color: #f0f8ff;
            border: 5px solid var(--primary-color);
            overflow: hidden;
        }

        .wheel-canvas {
            width: 100%;
            height: 100%;
            display: block;
            transform: rotate(0deg);
            transition: transform 5s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .spin-button {
            font-family: 'Poppins', sans-serif;
            background-color: var(--primary-color);
            color: #fff;
            border: none;
            padding: 18px 35px;
            font-size: 1.3em;
            font-weight: bold;
            text-transform: uppercase;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            transition: transform 0.2s ease, background-color 0.2s ease, box-shadow 0.2s ease;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            border: 2px solid #fff;
            letter-spacing: 1px;
        }

        .spin-button:disabled {
            background-color: #adb5bd;
            cursor: not-allowed;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .spin-button:hover:not(:disabled) {
            transform: translate(-50%, -50%) scale(1.08);
            background-color: #0056b3;
            box-shadow: 10px 25px rgba(0, 0, 0, 0.3);
        }

        .pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 25px solid transparent;
            border-right: 25px solid transparent;
            border-bottom: 40px solid var(--accent-color);
            z-index: 5;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .results-section {
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px dashed #ced4da;
            position: relative;
            z-index: 1;
        }

        .results-section h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 25px;
        }

        .groups-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 30px;
            margin-top: 20px;
        }

        .group-card {
            width: 100%;
            max-width: 500px;
            padding: 25px;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            text-align: left;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            color: #fff;
            position: relative;
            overflow: hidden;
            box-sizing: border-box;
        }

        .group-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, rgba(255,255,255,0.1), rgba(0,0,0,0.1));
            z-index: 0;
        }

        .group-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.2);
        }

        #male-group-a { background-color: var(--group-a-bg); border: 2px solid var(--group-a-bg); }
        #male-group-b { background-color: var(--group-b-bg); border: 2px solid var(--group-b-bg); }
        #female-group-a { background-color: var(--group-a-bg); border: 2px solid var(--group-a-bg); }
        #female-group-b { background-color: var(--group-b-bg); border: 2px solid var(--group-b-bg); }
        #female-group-c { background-color: var(--group-c-bg); border: 2px solid var(--group-c-bg); }
        #female-group-d { background-color: var(--group-d-bg); border: 2px solid var(--group-d-bg); }

        .group-card h3 {
            font-family: 'Poppins', sans-serif;
            margin-top: 0;
            border-bottom: 2px solid rgba(255, 255, 255, 0.6);
            padding-bottom: 10px;
            margin-bottom: 15px;
            font-size: 1.8em;
            text-align: center;
            color: #fff;
            position: relative;
            z-index: 1;
        }

        .group-card ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            position: relative;
            z-index: 1;
        }

        .group-card li {
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.3);
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            font-size: 1.1em;
        }
        .group-card li:last-child { border-bottom: none; }
        .participant-name { font-weight: 600; margin-bottom: 2px; }
        .participant-department { font-size: 0.9em; font-style: italic; opacity: 0.9; }

        .final-results-container {
            display: none;
            width: 100%;
            max-width: 600px;
            margin: 40px auto;
            text-align: left;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--card-shadow);
            background-color: #fff;
            border: 3px solid var(--primary-color);
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }

        .final-results-container h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 2.2em;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .final-group {
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #ced4da;
        }
        .final-group:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        .final-group-header {
            font-family: 'Poppins', sans-serif;
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            text-align: center;
        }

        #male-final-group-a-header { background-color: var(--group-a-bg); }
        #male-final-group-b-header { background-color: var(--group-b-bg); }
        #female-final-group-a-header { background-color: var(--group-a-bg); }
        #female-final-group-b-header { background-color: var(--group-b-bg); }
        #female-final-group-c-header { background-color: var(--group-c-bg); }
        #female-final-group-d-header { background-color: var(--group-d-bg); }

        .final-group ul { list-style-type: none; padding: 0; margin: 0; }
        .final-group li { font-size: 1.1em; padding: 8px 0; border-bottom: 1px dashed #ced4da; }
        .final-group li:last-child { border-bottom: none; }

        /* Pop-up Styles */
        #popup {
            display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background-color: #fff; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            padding: 40px 50px; z-index: 100; text-align: center; opacity: 0;
            transition: opacity 0.5s ease-in-out; border: 4px solid var(--accent-color);
        }
        #popup.show { display: block; opacity: 1; }
        #popup h4 { font-family: 'Poppins', sans-serif; font-size: 2.5em; color: var(--primary-color); margin: 0 0 10px 0; text-transform: uppercase; }
        #popup p { font-family: 'Lato', sans-serif; font-size: 1.8em; font-weight: bold; color: var(--secondary-color); margin: 0; }
        
        #overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(5px); z-index: 99;
        }
        #overlay.show { display: block; }
    </style>
</head>
<body>
    <div class="navbar">
        <a id="male-link" class="male-link active">Male Draw</a>
        <a id="female-link" class="female-link">Female Draw</a>
    </div>

    <div class="container" id="male-draw-container">
        <h1>Clinix Cup 2025</h1>
        <h2>Single Male Grouping Draw</h2>
        
        <div id="male-draw-process">
            <div class="spin-wheel-section">
                <div class="wheel-container">
                    <div class="pointer"></div>
                    <canvas id="male-wheel-canvas" class="wheel-canvas" width="700" height="700"></canvas>
                    <button id="male-spin-button" class="spin-button">Spin to Draw</button>
                </div>
            </div>
            <div class="results-section">
                <h3>Draw Results</h3>
                <div class="groups-container">
                    <div id="male-group-a" class="group-card">
                        <h3>Group A (6 Participants)</h3>
                        <ul id="male-group-a-list"></ul>
                    </div>
                    <div id="male-group-b" class="group-card">
                        <h3>Group B (7 Participants)</h3>
                        <ul id="male-group-b-list"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="male-final-results-container" class="final-results-container">
            <h3>Final Clinix Cup 2025 Grouping</h3>
            <div class="final-group">
                <div id="male-final-group-a-header" class="final-group-header">Group A</div>
                <ul id="male-final-group-a-list"></ul>
            </div>
            <div class="final-group">
                <div id="male-final-group-b-header" class="final-group-header">Group B</div>
                <ul id="male-final-group-b-list"></ul>
            </div>
        </div>
    </div>

    <div class="container" id="female-draw-container" style="display: none;">
        <h1>Clinix Cup 2025</h1>
        <h2>Single Female Grouping Draw</h2>
        
        <div id="female-draw-process">
            <div class="spin-wheel-section">
                <div class="wheel-container">
                    <div class="pointer"></div>
                    <canvas id="female-wheel-canvas" class="wheel-canvas" width="700" height="700"></canvas>
                    <button id="female-spin-button" class="spin-button">Spin to Draw</button>
                </div>
            </div>
            <div class="results-section">
                <h3>Draw Results</h3>
                <div class="groups-container">
                    <div id="female-group-a" class="group-card">
                        <h3>Group A (3 Participants)</h3>
                        <ul id="female-group-a-list"></ul>
                    </div>
                    <div id="female-group-b" class="group-card">
                        <h3>Group B (3 Participants)</h3>
                        <ul id="female-group-b-list"></ul>
                    </div>
                    <div id="female-group-c" class="group-card">
                        <h3>Group C (4 Participants)</h3>
                        <ul id="female-group-c-list"></ul>
                    </div>
                    <div id="female-group-d" class="group-card">
                        <h3>Group D (4 Participants)</h3>
                        <ul id="female-group-d-list"></ul>
                    </div>
                </div>
            </div>
        </div>

        <div id="female-final-results-container" class="final-results-container">
            <h3>Final Clinix Cup 2025 Grouping</h3>
            <div class="final-group">
                <div id="female-final-group-a-header" class="final-group-header">Group A</div>
                <ul id="female-final-group-a-list"></ul>
            </div>
            <div class="final-group">
                <div id="female-final-group-b-header" class="final-group-header">Group B</div>
                <ul id="female-final-group-b-list"></ul>
            </div>
            <div class="final-group">
                <div id="female-final-group-c-header" class="final-group-header">Group C</div>
                <ul id="female-final-group-c-list"></ul>
            </div>
            <div class="final-group">
                <div id="female-final-group-d-header" class="final-group-header">Group D</div>
                <ul id="female-final-group-d-list"></ul>
            </div>
        </div>
    </div>

    <div id="overlay"></div>
    <div id="popup">
        <p id="popup-name"></p>
        <h4 id="popup-group"></h4>
    </div>

    <script>
        const departmentColors = {
            'CARDIOLOGY': '#e74c3c',
            'NURSING': '#3498db',
            'ANAESTHESIA & INT. CARE': '#9b59b6',
            'ED & PCHC': '#1abc9c',
            'CARDIOTHORACIC': '#f39c12'
        };

        // Helper functions
        function truncateText(text, maxWidth, font, canvasContext) {
            canvasContext.font = font;
            let width = canvasContext.measureText(text).width;
            if (width <= maxWidth) {
                return text;
            }
            let ellipsis = '...';
            let ellipsisWidth = canvasContext.measureText(ellipsis).width;
            let tempText = text;
            while (width >= maxWidth - ellipsisWidth && tempText.length > 0) {
                tempText = tempText.substring(0, tempText.length - 1);
                width = canvasContext.measureText(tempText).width;
            }
            return tempText + ellipsis;
        }

        function showPopup(name, group) {
            const popup = document.getElementById('popup');
            const popupName = document.getElementById('popup-name');
            const popupGroup = document.getElementById('popup-group');
            const overlay = document.getElementById('overlay');
            
            popupName.textContent = name;
            popupGroup.textContent = `GROUP ${group}`;
            
            overlay.classList.add('show');
            popup.classList.add('show');
            
            setTimeout(() => {
                popup.classList.remove('show');
                overlay.classList.remove('show');
            }, 1800);
        }
        
        function shuffle(array) {
            let shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // --- Male Draw Logic ---
        const maleParticipants = [
            { name: 'Koh Hui Beng', department: 'CARDIOLOGY' },
            { name: 'Ow Ji Ken', department: 'CARDIOLOGY' },
            { name: 'Faiz Mashood', department: 'CARDIOLOGY' },
            { name: 'Haizul Iskandar Sapawi', department: 'NURSING' },
            { name: 'Muhammad Danial Zulkepli', department: 'NURSING' },
            { name: 'Muhammad Nasarudin', department: 'NURSING' },
            { name: 'Mohd Amir Hakim', department: 'ANAESTHESIA & INT. CARE' },
            { name: 'Dr Eizzuddin', department: 'ANAESTHESIA & INT. CARE' },
            { name: 'Mohd Ariff Nasri', department: 'ED & PCHC' },
            { name: 'Dr Mohd Nizam Mahmud', department: 'ED & PCHC' },
            { name: 'Zahid', department: 'CARDIOTHORACIC' },
            { name: 'Dr Nazrin', department: 'CARDIOTHORACIC' },
            { name: 'Dr Mohd Azri', department: 'CARDIOTHORACIC' }
        ];

        let maleAvailableParticipants = shuffle(maleParticipants);
        let maleGroupA = [];
        let maleGroupB = [];
        let maleCurrentRotation = 0;

        const maleWheelCanvas = document.getElementById('male-wheel-canvas');
        const maleCtx = maleWheelCanvas.getContext('2d');
        const maleSpinButton = document.getElementById('male-spin-button');
        const maleGroupAList = document.getElementById('male-group-a-list');
        const maleGroupBList = document.getElementById('male-group-b-list');
        const maleDrawProcessSection = document.getElementById('male-draw-process');
        const maleFinalResultsContainer = document.getElementById('male-final-results-container');
        const maleFinalGroupAList = document.getElementById('male-final-group-a-list');
        const maleFinalGroupBList = document.getElementById('male-final-group-b-list');

        function maleDrawWheel() {
            if (maleAvailableParticipants.length === 0) {
                maleCtx.clearRect(0, 0, maleWheelCanvas.width, maleWheelCanvas.height);
                return;
            }

            const centerX = maleWheelCanvas.width / 2;
            const centerY = maleWheelCanvas.height / 2;
            const radius = Math.min(centerX, centerY) - 20;
            const arcSize = (360 / maleAvailableParticipants.length);

            maleCtx.clearRect(0, 0, maleWheelCanvas.width, maleWheelCanvas.height);
            maleCtx.strokeStyle = '#fff';
            maleCtx.lineWidth = 3;

            maleAvailableParticipants.forEach((p, i) => {
                const angleStart = (i * arcSize) * (Math.PI / 180);
                const angleEnd = ((i + 1) * arcSize) * (Math.PI / 180);
                const color = departmentColors[p.department] || '#ccc';
                
                maleCtx.beginPath();
                maleCtx.moveTo(centerX, centerY);
                maleCtx.arc(centerX, centerY, radius, angleStart, angleEnd);
                maleCtx.closePath();
                maleCtx.fillStyle = color;
                maleCtx.fill();
                maleCtx.stroke();

                maleCtx.save();
                maleCtx.translate(centerX, centerY);
                maleCtx.rotate((angleStart + angleEnd) / 2);
                maleCtx.fillStyle = '#fff';
                maleCtx.font = 'bold 20px "Poppins", sans-serif';
                maleCtx.textAlign = 'right';
                maleCtx.textBaseline = 'middle';
                
                const textMargin = 30;
                const maxTextWidth = radius - textMargin - 10;
                const displayedName = truncateText(p.name, maxTextWidth, maleCtx.font, maleCtx);

                maleCtx.fillText(displayedName, radius - textMargin, 0);
                maleCtx.restore();
            });

            maleCtx.beginPath();
            maleCtx.arc(centerX, centerY, 80, 0, 2 * Math.PI);
            maleCtx.fillStyle = '#f8f9fa';
            maleCtx.fill();
            maleCtx.strokeStyle = '#007bff';
            maleCtx.lineWidth = 5;
            maleCtx.stroke();
        }

        function maleSpinWheel() {
            if (maleGroupA.length === 6) {
                maleFillGroupB();
                return;
            }
            if (maleAvailableParticipants.length === 0) return;

            maleSpinButton.disabled = true;
            maleSpinButton.innerText = 'Spinning...';

            const randomIndex = Math.floor(Math.random() * maleAvailableParticipants.length);
            const degreesPerSegment = 360 / maleAvailableParticipants.length;

            const targetSegmentStartAngle = randomIndex * degreesPerSegment;
            const targetRotation = (360 * 5) + (270 - targetSegmentStartAngle) - (degreesPerSegment / 2);

            maleWheelCanvas.style.transition = 'transform 5s cubic-bezier(0.25, 0.1, 0.25, 1)';
            maleWheelCanvas.style.transform = `rotate(${targetRotation}deg)`;

            setTimeout(() => {
                maleCurrentRotation = targetRotation % 360;
                maleWheelCanvas.style.transition = 'none';
                maleWheelCanvas.style.transform = `rotate(${maleCurrentRotation}deg)`;

                const drawnParticipant = maleAvailableParticipants.splice(randomIndex, 1)[0];
                const groupName = maleGroupA.length < 6 ? 'A' : 'B';
                showPopup(drawnParticipant.name, groupName);
                
                setTimeout(() => {
                    maleAddToGroup(drawnParticipant);
                    maleDrawWheel();
                    if (maleGroupA.length === 6) {
                        maleFillGroupB();
                    } else if (maleAvailableParticipants.length > 0) {
                        maleSpinButton.disabled = false;
                        maleSpinButton.innerText = 'Spin to Draw';
                    } else {
                        maleDisplayFinalResults();
                    }
                }, 2000);
            }, 5000);
        }

        function maleAddToGroup(participant) {
            const groupA_size = 6;
            let targetGroup = null;
            if (maleGroupA.length < groupA_size) {
                maleGroupA.push(participant);
                targetGroup = maleGroupAList;
            }
            const listItem = document.createElement('li');
            listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
            targetGroup.appendChild(listItem);
        }
        
        function maleFillGroupB() {
            maleSpinButton.disabled = true;
            maleSpinButton.innerText = 'Finalizing Group B...';
            
            maleAvailableParticipants.forEach(participant => {
                maleGroupB.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                maleGroupBList.appendChild(listItem);
            });
            maleAvailableParticipants = [];
            
            maleDisplayFinalResults();
        }

        function maleDisplayFinalResults() {
            maleDrawProcessSection.style.display = 'none';
            maleFinalResultsContainer.style.display = 'block';

            maleGroupA.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                maleFinalGroupAList.appendChild(listItem);
            });
            maleGroupB.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                maleFinalGroupBList.appendChild(listItem);
            });
        }
        
        maleSpinButton.addEventListener('click', maleSpinWheel);

        // --- Female Draw Logic ---
        const femaleParticipants = [
            { name: 'Nabila', department: 'CARDIOLOGY' },
            { name: 'Fuziana', department: 'CARDIOLOGY' },
            { name: 'Nik Hasnita', department: 'CARDIOLOGY' },
            { name: 'Navanita', department: 'CARDIOLOGY' },
            { name: 'Jassie Teo', department: 'CARDIOLOGY' },
            { name: 'Nor Atika', department: 'NURSING' },
            { name: 'Wani Irdina', department: 'NURSING' },
            { name: 'Nawwar Nazihah Ikramah', department: 'NURSING' },
            { name: 'Dr Kogilavani', department: 'ANAESTHESIA & INT. CARE' },
            { name: 'Siti Khadijah', department: 'ANAESTHESIA & INT. CARE' },
            { name: 'Siti Norfazidah', department: 'ANAESTHESIA & INT. CARE' },
            { name: 'Ruhaida Abdullah', department: 'ED & PCHC' },
            { name: 'SA Hamzi', department: 'CARDIOTHORACIC' },
            { name: 'Aimie', department: 'CARDIOTHORACIC' }
        ];

        let femaleAvailableParticipants = shuffle(femaleParticipants);
        let femaleGroupA = [];
        let femaleGroupB = [];
        let femaleGroupC = [];
        let femaleGroupD = [];
        let femaleCurrentRotation = 0;

        const femaleWheelCanvas = document.getElementById('female-wheel-canvas');
        const femaleCtx = femaleWheelCanvas.getContext('2d');
        const femaleSpinButton = document.getElementById('female-spin-button');
        const femaleGroupAList = document.getElementById('female-group-a-list');
        const femaleGroupBList = document.getElementById('female-group-b-list');
        const femaleGroupCList = document.getElementById('female-group-c-list');
        const femaleGroupDList = document.getElementById('female-group-d-list');
        const femaleDrawProcessSection = document.getElementById('female-draw-process');
        const femaleFinalResultsContainer = document.getElementById('female-final-results-container');
        const femaleFinalGroupAList = document.getElementById('female-final-group-a-list');
        const femaleFinalGroupBList = document.getElementById('female-final-group-b-list');
        const femaleFinalGroupCList = document.getElementById('female-final-group-c-list');
        const femaleFinalGroupDList = document.getElementById('female-final-group-d-list');

        function femaleDrawWheel() {
            if (femaleAvailableParticipants.length === 0) {
                femaleCtx.clearRect(0, 0, femaleWheelCanvas.width, femaleWheelCanvas.height);
                return;
            }

            const centerX = femaleWheelCanvas.width / 2;
            const centerY = femaleWheelCanvas.height / 2;
            const radius = Math.min(centerX, centerY) - 20;
            const arcSize = (360 / femaleAvailableParticipants.length);

            femaleCtx.clearRect(0, 0, femaleWheelCanvas.width, femaleWheelCanvas.height);
            femaleCtx.strokeStyle = '#fff';
            femaleCtx.lineWidth = 3;

            femaleAvailableParticipants.forEach((p, i) => {
                const angleStart = (i * arcSize) * (Math.PI / 180);
                const angleEnd = ((i + 1) * arcSize) * (Math.PI / 180);
                const color = departmentColors[p.department] || '#ccc';
                
                femaleCtx.beginPath();
                femaleCtx.moveTo(centerX, centerY);
                femaleCtx.arc(centerX, centerY, radius, angleStart, angleEnd);
                femaleCtx.closePath();
                femaleCtx.fillStyle = color;
                femaleCtx.fill();
                femaleCtx.stroke();

                femaleCtx.save();
                femaleCtx.translate(centerX, centerY);
                femaleCtx.rotate((angleStart + angleEnd) / 2);
                femaleCtx.fillStyle = '#fff';
                femaleCtx.font = 'bold 20px "Poppins", sans-serif';
                femaleCtx.textAlign = 'right';
                femaleCtx.textBaseline = 'middle';
                
                const textMargin = 30;
                const maxTextWidth = radius - textMargin - 10;
                const displayedName = truncateText(p.name, maxTextWidth, femaleCtx.font, femaleCtx);

                femaleCtx.fillText(displayedName, radius - textMargin, 0);
                femaleCtx.restore();
            });

            femaleCtx.beginPath();
            femaleCtx.arc(centerX, centerY, 80, 0, 2 * Math.PI);
            femaleCtx.fillStyle = '#f8f9fa';
            femaleCtx.fill();
            femaleCtx.strokeStyle = '#007bff';
            femaleCtx.lineWidth = 5;
            femaleCtx.stroke();
        }

        function femaleSpinWheel() {
            if (femaleGroupD.length === 4) {
                femaleDisplayFinalResults();
                return;
            }
            if (femaleAvailableParticipants.length === 0) return;

            femaleSpinButton.disabled = true;
            femaleSpinButton.innerText = 'Spinning...';

            const randomIndex = Math.floor(Math.random() * femaleAvailableParticipants.length);
            const degreesPerSegment = 360 / femaleAvailableParticipants.length;

            const targetSegmentStartAngle = randomIndex * degreesPerSegment;
            const targetRotation = (360 * 5) + (270 - targetSegmentStartAngle) - (degreesPerSegment / 2);

            femaleWheelCanvas.style.transition = 'transform 5s cubic-bezier(0.25, 0.1, 0.25, 1)';
            femaleWheelCanvas.style.transform = `rotate(${targetRotation}deg)`;

            setTimeout(() => {
                femaleCurrentRotation = targetRotation % 360;
                femaleWheelCanvas.style.transition = 'none';
                femaleWheelCanvas.style.transform = `rotate(${femaleCurrentRotation}deg)`;

                const drawnParticipant = femaleAvailableParticipants.splice(randomIndex, 1)[0];
                let groupName = '';
                if (femaleGroupA.length < 3) groupName = 'A';
                else if (femaleGroupB.length < 3) groupName = 'B';
                else if (femaleGroupC.length < 4) groupName = 'C';
                else groupName = 'D';

                showPopup(drawnParticipant.name, groupName);
                
                setTimeout(() => {
                    femaleAddToGroup(drawnParticipant);
                    femaleDrawWheel();
                    if (femaleGroupA.length + femaleGroupB.length + femaleGroupC.length === 10) {
                        femaleFillGroupD();
                    } else if (femaleAvailableParticipants.length > 0) {
                        femaleSpinButton.disabled = false;
                        femaleSpinButton.innerText = 'Spin to Draw';
                    } else {
                        femaleDisplayFinalResults();
                    }
                }, 2000);
            }, 5000);
        }

        function femaleAddToGroup(participant) {
            if (femaleGroupA.length < 3) {
                femaleGroupA.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                femaleGroupAList.appendChild(listItem);
            } else if (femaleGroupB.length < 3) {
                femaleGroupB.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                femaleGroupBList.appendChild(listItem);
            } else if (femaleGroupC.length < 4) {
                femaleGroupC.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                femaleGroupCList.appendChild(listItem);
            } else { 
                femaleGroupD.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                femaleGroupDList.appendChild(listItem);
            }
        }
        
        function femaleFillGroupD() {
            femaleSpinButton.disabled = true;
            femaleSpinButton.innerText = 'Finalizing Group D...';
            
            femaleAvailableParticipants.forEach(participant => {
                femaleGroupD.push(participant);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<span class="participant-name">${participant.name}</span> <span class="participant-department">(${participant.department})</span>`;
                femaleGroupDList.appendChild(listItem);
            });
            femaleAvailableParticipants = [];
            
            femaleDisplayFinalResults();
        }

        function femaleDisplayFinalResults() {
            femaleDrawProcessSection.style.display = 'none';
            femaleFinalResultsContainer.style.display = 'block';

            femaleGroupA.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                femaleFinalGroupAList.appendChild(listItem);
            });
            femaleGroupB.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                femaleFinalGroupBList.appendChild(listItem);
            });
            femaleGroupC.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                femaleFinalGroupCList.appendChild(listItem);
            });
            femaleGroupD.forEach(p => {
                const listItem = document.createElement('li');
                listItem.textContent = p.name;
                femaleFinalGroupDList.appendChild(listItem);
            });
        }
        
        femaleSpinButton.addEventListener('click', femaleSpinWheel);

        // --- Tab Switching Logic ---
        const maleDrawContainer = document.getElementById('male-draw-container');
        const femaleDrawContainer = document.getElementById('female-draw-container');
        const maleLink = document.getElementById('male-link');
        const femaleLink = document.getElementById('female-link');

        function showDraw(drawType) {
            if (drawType === 'male') {
                maleDrawContainer.style.display = 'block';
                femaleDrawContainer.style.display = 'none';
                maleLink.classList.add('active');
                femaleLink.classList.remove('active');
                maleDrawWheel();
            } else if (drawType === 'female') {
                maleDrawContainer.style.display = 'none';
                femaleDrawContainer.style.display = 'block';
                maleLink.classList.remove('active');
                femaleLink.classList.add('active');
                femaleDrawWheel();
            }
        }

        maleLink.addEventListener('click', () => showDraw('male'));
        femaleLink.addEventListener('click', () => showDraw('female'));

        // Initial draw on page load
        showDraw('male');
    </script>
</body>
</html>
